<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Producto – Moda MX</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family:system-ui, -apple-system, sans-serif; background:#fff; color:#111; line-height:1.6; }
    header { position:fixed; top:0; width:100%; background:#fff; border-bottom:1px solid #eee; z-index:100; }
    nav { max-width:1400px; margin:0 auto; padding:1.2rem 5%; display:flex; justify-content:space-between; align-items:center; }
    .logo { font-size:1.35rem; font-weight:500; letter-spacing:0.05em; }
    .nav-links a { color:#333; text-decoration:none; margin-left:2.2rem; font-size:0.95rem; }
    .nav-links a:hover { color:#000; }
    .cart { font-size:1.2rem; color:#222; }
    main { padding-top:100px; max-width:1200px; margin:0 auto; padding:100px 5% 80px; }
    .product-detail { display:grid; grid-template-columns:1fr 1fr; gap:4rem; }
    
    /* Carrusel */
    .carousel-container {
      position: relative;
      width: 100%;
      overflow: hidden;
      border-radius: 4px;
    }
    .carousel {
      display: flex;
      transition: transform 0.4s ease;
    }
    .carousel img {
      width: 100%;
      height: auto;
      flex-shrink: 0;
      object-fit: cover;
    }
    .carousel-arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0,0,0,0.4);
      color: white;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0.7;
      transition: opacity 0.2s;
    }
    .carousel-arrow:hover { opacity: 1; }
    .carousel-arrow.prev { left: 10px; }
    .carousel-arrow.next { right: 10px; }
    .carousel-dots {
      text-align: center;
      margin-top: 1rem;
    }
    .dot {
      display: inline-block;
      width: 10px;
      height: 10px;
      margin: 0 6px;
      background: #ddd;
      border-radius: 50%;
      cursor: pointer;
      transition: background 0.3s;
    }
    .dot.active { background: #333; }

    .info h1 { font-size:1.8rem; font-weight:400; margin-bottom:1rem; }
    .price { font-size:1.5rem; font-weight:500; margin-bottom:1.5rem; }
    .description { color:#555; margin-bottom:2rem; font-size:1.05rem; }
    .options { margin-bottom:2rem; }
    .options label { display:block; margin:1rem 0 0.5rem; font-weight:500; }
    select, .sizes { padding:0.8rem; border:1px solid #ddd; background:#fff; font-size:1rem; width:100%; max-width:300px; }
    .sizes button { margin:0.3rem; padding:0.6rem 1rem; border:1px solid #ccc; background:transparent; cursor:pointer; min-width:50px; }
    .sizes button.active { border-color:#000; background:#f8f8f8; }
    .btn { display:inline-block; padding:1rem 2.5rem; background:#000; color:#fff; text-decoration:none; font-weight:500; transition:background 0.25s; border:none; cursor:pointer; }
    .btn:hover { background:#222; }
    .back { margin:3rem 0; display:inline-block; color:#555; text-decoration:none; font-size:0.95rem; }
    .back:hover { color:#000; }

    @media (max-width:900px) {
      .product-detail { grid-template-columns:1fr; gap:3rem; }
      .carousel-arrow { width:36px; height:36px; font-size:1rem; }
    }
  </style>
</head>
<body>

  <header>
    <nav>
      <div class="logo"><a href="index.html" style="color:#000; text-decoration:none;">Moda MX</a></div>
      <div class="nav-links">
        <a href="#">Mujer</a>
        <a href="#">Hombre</a>
        <a href="#">Novedades</a>
      </div>
      <div class="cart"><i class="far fa-bag-shopping"></i></div>
    </nav>
  </header>

  <main>
    <a href="index.html" class="back">← Volver a la colección</a>

    <div class="product-detail" id="productDetail">
      <div class="carousel-container">
        <div class="carousel" id="carousel"></div>
        <button class="carousel-arrow prev" id="prevBtn"><i class="fas fa-chevron-left"></i></button>
        <button class="carousel-arrow next" id="nextBtn"><i class="fas fa-chevron-right"></i></button>
        <div class="carousel-dots" id="dots"></div>
      </div>

      <div class="info">
        <h1 id="name"></h1>
        <div class="price" id="price"></div>
        <p class="description" id="description"></p>

        <div class="options">
          <label>Talla</label>
          <div class="sizes" id="sizes"></div>

          <label>Color</label>
          <select id="color">
            <!-- Se llena dinámicamente si hay colores en JSON -->
          </select>
        </div>

        <button class="btn">Añadir al carrito</button>
      </div>
    </div>
  </main>

  <script>
    const products = []; // Se llenará desde JSON

    fetch('productos.json')
      .then(response => {
        if (!response.ok) throw new Error('No se pudo cargar productos.json');
        return response.json();
      })
      .then(data => {
        products.push(...data);
        const urlParams = new URLSearchParams(window.location.search);
        const id = parseInt(urlParams.get('id'));
        const product = products.find(p => p.id === id);

        if (product) {
          document.getElementById('name').textContent = product.name;
          document.getElementById('price').textContent = `${product.price} ${product.currency || 'MXN'}`;
          document.getElementById('description').textContent = product.description;
          document.title = `${product.name} – Moda MX`;

          // Carrusel
          const carousel = document.getElementById('carousel');
          const dotsContainer = document.getElementById('dots');
          let currentIndex = 0;

          // Usamos 'images' del JSON, fallback a 'image' si solo hay una
          const images = product.images && product.images.length > 0 
            ? product.images 
            : [product.image];

          images.forEach((imgSrc, index) => {
            const img = document.createElement('img');
            img.src = imgSrc;
            img.alt = `${product.name} - vista ${index + 1}`;
            carousel.appendChild(img);

            // Punto indicador
            const dot = document.createElement('span');
            dot.className = 'dot';
            dot.onclick = () => goToSlide(index);
            dotsContainer.appendChild(dot);
          });

          const dots = dotsContainer.querySelectorAll('.dot');
          if (dots.length > 0) dots[0].classList.add('active');

          // Funciones de navegación
          function updateCarousel() {
            carousel.style.transform = `translateX(-${currentIndex * 100}%)`;
            dots.forEach((dot, i) => {
              dot.classList.toggle('active', i === currentIndex);
            });
          }

          function goToSlide(index) {
            currentIndex = (index + images.length) % images.length;
            updateCarousel();
          }

          document.getElementById('nextBtn').onclick = () => goToSlide(currentIndex + 1);
          document.getElementById('prevBtn').onclick = () => goToSlide(currentIndex - 1);

          // Ocultar flechas si solo hay 1 imagen
          if (images.length <= 1) {
            document.getElementById('prevBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'none';
            dotsContainer.style.display = 'none';
          }

          // Tallas
          const sizesDiv = document.getElementById('sizes');
          sizesDiv.innerHTML = '';
          (product.sizes || ['S', 'M', 'L', 'XL']).forEach(size => {
            const btn = document.createElement('button');
            btn.textContent = size;
            btn.onclick = () => {
              sizesDiv.querySelectorAll('button').forEach(b => b.classList.remove('active'));
              btn.classList.add('active');
            };
            sizesDiv.appendChild(btn);
          });

          // Colores (si existen en JSON)
          const colorSelect = document.getElementById('color');
          if (product.colors && product.colors.length > 0) {
            colorSelect.innerHTML = '';
            product.colors.forEach(color => {
              const option = document.createElement('option');
              option.value = color;
              option.textContent = color;
              colorSelect.appendChild(option);
            });
          }

        } else {
          document.getElementById('productDetail').innerHTML = 
            '<h2>Producto no encontrado</h2>' +
            '<a href="index.html" class="back">Volver a la colección</a>';
        }
      })
      .catch(error => {
        console.error('Error al cargar:', error);
        document.getElementById('productDetail').innerHTML = 
          '<h2>Error al cargar el producto</h2>' +
          '<p>Verifica que productos.json exista.</p>' +
          '<a href="index.html" class="back">Volver</a>';
      });
  </script>

</body>
</html>